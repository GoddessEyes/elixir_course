# Defensive Programming vs Let It Crash

Когда вся программа выполняется в одном потоке, аварийное завершение этого потока означает аварийное завершение программы. И если это случилось в месте, где явно не предусмотрена обработка ошибок, то остается минимум информации для диагностики проблемы.

Поэтому программисты стараются предусмотреть обработку всех возможных ошибок во всех возможных местах. Такой стиль программирования называется **Defensive Programming**. И он может привести к тому, что программа содержит больше кода для обработки ошибок, чем кода, выполняющего основную задачу. Конечно, это усложняет и написание кода, и поддержку.

Эликсир предлагает другой подход: реализовать только основную задачу (**happy path**) и не писать код для обработки ошибок. Благодаря многопоточности и разделению ролей между **рабочими потоками** и **супервизорами**, любая ошибка всегда будет обработана и записана в лог. А система в целом продолжит работу. Этот подход называется **Let It Crash**.

Между тем, все инструменты для Defensive Programming в Эликсир есть, и мы их уже рассмотрели. Полностью от этого подхода никто не отказывается. На практике каждый проект ищет свой баланс между **Defensive Programming** и **Let It Crash**.

Например, популярный веб-сервер **Cowboy**, стандарт де-факто для Эликсир и Эрланг проектов, на 25К строк кода и 23К строк тестов применяет исключения около 180 раз. (Данные для версии 2.6.3 суммарно по трем библиотекам: cowboy, cowlib и ranch). То есть, одно исключение на 260 строк кода. А популярная библиотека для работы с БД -- **Ecto** (версия 3.3.2) на 28К строк кода применяет исключения 300 раз. Одно исключение на 90 строк кода.

Для сравнения возьмем язык Python, где применение исключенией для управления потоком выполнения является нормальной практикой. Фреймворк **Django** версии 3.2 на 376К строк кода применяет исключения 20К раз. Одно исключение на 20 строк кода. 

Подход **Let It Crash** самодостаточный, так что вполне реально написать полноценный проект вообще не используя исключения.
