# Сопоставление с образцом для словарей (map)

Есть некоторые нюансы сопоставления с образцом при работе со словарями. В шаблоне не нужно перечислять все ключи, какие есть в словаре. Мы указываем только те ключи, которые нам нужны:

```elixir-iex
iex(4)> my_map = %{a: 1, b: 2, c: 3}
%{a: 1, b: 2, c: 3}
iex(5)> %{a: value} = my_map
%{a: 1, b: 2, c: 3}
iex(6)> value
1
```

Можно извлечь несколько значений одновременно:

```elixir-iex
iex(2)> %{a: a_val, b: b_val} = my_map
%{a: 1, b: 2, c: 3}
iex(3)> a_val
1
iex(4)> b_val 
2
```

Если в словаре нет нужного ключа, то возникает исключение `MatchError`:

```elixir-iex
iex(7)> %{d: val} = my_map
** (MatchError) no match of right hand side value: %{a: 1, b: 2, c: 3}
```

Если ключи не являются атомами, то синтаксис отличается:

```elixir-iex
iex(7)> my_map = %{"a" => 1, "b" => 2, "c" => 3}
%{"a" => 1, "b" => 2, "c" => 3}
iex(8)> %{"a" => value1} = my_map
%{"a" => 1, "b" => 2, "c" => 3}
iex(9)> %{"a" => value1, "b" => value2} = my_map
%{"a" => 1, "b" => 2, "c" => 3}
iex(10)> value1
1
iex(11)> value2
2
```

Шаблон `%{}` совпадает с любым словарём. Это контринтуитивно, можно было бы ожидать, что этот шаблон совпадает только с пустым словарём. Этим шаблоном нельзя ничего извлечь, но можно проверить, что значение является словарём, а не чем-то иным.

```elixir-iex
iex(13)> %{} = my_map
%{"a" => 1, "b" => 2, "c" => 3}
```

Переменные можно использовать для извлечения значений, но не для извлечения ключей:

```elixir-iex
iex(15)> %{"c" => my_var} = my_map
%{"a" => 1, "b" => 2, "c" => 3}
iex(16)> my_var
3
iex(17)> %{my_var => 1} = my_map
** (CompileError) iex:17: cannot use variable my_var as map key inside a pattern.
```

Это очевидно, так как значения не уникальны, и если есть несколько одинаковых значений, то непонятно, какой именно нужен ключ.

А _pin_ operator можно использовать и для ключа, и для значения:

```elixir-iex
iex(18)> value1
1
iex(19)> %{"a" => ^value1} = my_map
%{"a" => 1, "b" => 2, "c" => 3}
iex(20)> keyb = "b"
"b"
iex(21)> %{^keyb => _} = my_map
%{"a" => 1, "b" => 2, "c" => 3
```

Вариант `%{"a" => ^value1} = my_map` эквивалентен `%{"a" => 1} = my_map`. То есть, такой шаблон проверяет, что в словаре есть ключ и именно с таким значением.
